## Nipah virus (NiV) – Testing Management System


**Bug Description:**

A vulnerability has been found in Nipah virus (NiV) – Testing Management System 1.0 and classified as critical. Phpgurukul's Nipah virus (NiV) – Testing Management System Using PHP and MySQL 1.0
has a SQL injection vulnerability in "add-phlebotomist.php" endpoint. The manipulation of the parameter "empid" leads to SQL injection. Remote attackers can leverage this vulnerability to manipulate a web application's SQL query by injecting malicious SQL code.
This can lead to unauthorized access to databases, data theft, data manipulation, and other malicious activities.


**Steps to Reproduce:** 

```
# Exploit Title: SQL Injection vulnerability in PHPGurukul Nipah virus (NiV) – Testing Management System
# Date: 28-11-2023
# Exploit Author: dhabaleshwardas
# Vendor Homepage: https://phpgurukul.com/
# Software Link: https://phpgurukul.com/nipah-virus-niv-testing-management-system-using-php-and-mysql/
# Version: 1.0
# Tested on: firefox/chrome/brave
# CVE : 
```


To reproduce the attack:

1- Login to the Niv Application and head to http://localhost/nipah-tms/add-phlebotomist.php endpoint

<img width="725" alt="1" src="https://github.com/dhabaleshwar/niv_testing_sqli/assets/132373212/de2daaab-57f9-4a13-80c4-1e0eb2579347">


2- Here you would be asked to add a phlebotomist and fill out all the details. We give some random value in those parameters and intercept the request.

<img width="671" alt="2" src="https://github.com/dhabaleshwar/niv_testing_sqli/assets/132373212/f00fed0c-c0be-4a9b-87a2-f23dd1e22c45">


3- Copy and Save this request in your system, here I saved it in a file "request3.txt".



4- Next we use sqlmap and try to automate the query to find out if any of the three parameters in our "request3" file is vulnerable to sql injection.

<img width="872" alt="3" src="https://github.com/dhabaleshwar/niv_testing_sqli/assets/132373212/f243fc78-959e-4761-94ce-65b696b46c22">

5- We find out that the parameter "empid" is vulnerable to sql injection and we got all the databases.

<img width="912" alt="4" src="https://github.com/dhabaleshwar/niv_testing_sqli/assets/132373212/5e8c275a-352f-4717-955f-8645c19d1cee">

5-  This is a critical vulnerability as it can lead to unauthorized access to databases, data theft, data manipulation, and other malicious activities.

**Remediation:** 

1- Use prepared statements with parameterized queries. In PHP, you can use PDO (PHP Data Objects) or MySQLi (MySQL Improved) to achieve this.

2- Use stored procedures whenever possible. Stored procedures can help prevent SQL injection by encapsulating the SQL code and allowing the database to execute only the stored procedure.

3- Ensure that your MySQL user accounts have the minimum necessary privileges. Avoid using accounts with global or unnecessary permissions.

